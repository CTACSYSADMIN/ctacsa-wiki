<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>LDAP on Documentation for Hugo Learn Theme</title>
    <link>//localhost:1313/en/kb/tools_processes/ldap/</link>
    <description>Recent content in LDAP on Documentation for Hugo Learn Theme</description>
    <generator>Hugo</generator>
    <language>en</language>
    <lastBuildDate>Sat, 05 Feb 2022 10:31:29 -0500</lastBuildDate>
    <atom:link href="//localhost:1313/en/kb/tools_processes/ldap/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ldap refresh migration server data from source</title>
      <link>//localhost:1313/en/kb/tools_processes/ldap/ldap-refresh-migration-server-data-from-source/</link>
      <pubDate>Sat, 05 Feb 2022 10:31:29 -0500</pubDate>
      <guid>//localhost:1313/en/kb/tools_processes/ldap/ldap-refresh-migration-server-data-from-source/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Knowledge Base Article - CTAC (Communications Training Analysis Corporation)  &#xA;=================================================&#xA;&#xA;Subject: Reload migration LDAP server from source LDAP server&#xA;&#xA;Revision History:&#xA;    2015-05-15 14:50:46 - Version 1 created by Paul Rigor&#xA;&#xA;Details: (include steps to reproduce, symptoms, corrective actions, contact information, links and a any other helpful information)&#xA;&#xA; The following KB applies when you must refresh the data in an LDAP database located in a migration network.  (E.g. HHS AWS 10.153 to HHS 10.140)&#xA;&#xA; IMPORTANT:  There will be some downtime on the destination server.  There is also some risk of losing the ability to authenticate to instances and services that use LDAP if something were to go wrong.  Make an image or snapshot before following this procedure.&#xA;&#xA; On the source LDAP server:&#xA;&#xA; As Root:&#xA;&#xA; &amp;gt; slapcat &amp;gt; {customer}-ldap-{MMDD}.ldif  (e.g. hhs-ldap-0514.ldif) &#xA; &amp;gt; gzip  {customer}-ldap-{MMDD}.ldif&#xA;&#xA; IMPORTANT:  download the file (do not S3 it.. ) keep it secure and under control at all times.. clean up after yourself!&#xA;&#xA; Before sending the file to the destination server:&#xA;&#xA;   * Edit the ldif file and make any changes such as (dc=domain to dc=hhs or the like) .. be sure to do it globally.&#xA;&#xA; Upload the ldif file to the destination LDAP server...then..&#xA;&#xA;  Note: This process will take a several minutes to complete.  You only need to do this on the primary ldap server.&#xA;&#xA; &amp;gt; service slapd stop&#xA; &amp;gt; cd /var/lib/ldap&#xA; &amp;gt; find . -maxdepth 1 ! -name &amp;#34;DB_CONFIG&amp;#34; -type f -delete&#xA; &amp;gt; slapadd -l /path/to/{customer}-ldap-{MMDD}.ldif &#xA; &amp;gt; chown -R openldap:openldap /var/lib/ldap/*&#xA; &amp;gt; service slapd start&#xA;&#xA;&#xA;service slapd stop;cd /var/lib/ldap;find . -maxdepth 1 ! -name &amp;#34;DB_CONFIG&amp;#34; -type f -delete;cd /home/prigor;slapadd -l hhs-ldap-0618.ldif; chown -R openldap:openldap /var/lib/ldap/*;service slapd start&#xA;&#xA;You are done...  If anything should go wrong.. you should restore from snapshot/image.&#xA;&#xA;&#xA;&#xA;=================================================&#xA;This document is proprietary and confidential. No part of this document may be &#xA;disclosed in any manner to a third party without the prior written consent of &#xA;CTAC.```&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>ldap tips and tricks</title>
      <link>//localhost:1313/en/kb/tools_processes/ldap/ldap-tips-and-tricks/</link>
      <pubDate>Sat, 05 Feb 2022 10:31:29 -0500</pubDate>
      <guid>//localhost:1313/en/kb/tools_processes/ldap/ldap-tips-and-tricks/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;IKnowledge Base Article - CTAC (Communications Training Analysis Corporation)  &#xA;=================================================&#xA;&#xA;Subject: LDAP Tips and Tricks&#xA;&#xA;Revision History:&#xA;    2014-10-31 10:52:53 - Version 1 created by Paul Rigor&#xA;    2015-05-15 17:15:00 - Added replication testing - Paul Rigor&#xA;    2015-06-15 16:15:00 - Added openam / wcdsso info - Paul Rigor&#xA;    2015-06-17 12:00:00 - AMS LDAP Tunnel Info - Paul Rigor&#xA;    2015-06-24 09:40:00 - slappasswd info - Paul Rigor&#xA;&#xA;&#xA;Details: (include steps to reproduce, symptoms, corrective actions, contact information, links and a any other helpful information)&#xA;&#xA;&#xA;Encrypting passwords.&#xA;&#xA;to encrypt passwords via the command line use: &#xA;&#xA;&amp;gt;slappasswd -h &amp;#39;{SSHA}&amp;#39; -s &amp;lt;password&amp;gt;&#xA;&#xA;to use in bash (example):&#xA;&#xA;P=$(slappasswd -h &amp;#39;{SSHA}&amp;#39; -s sdfdfsdfsdfs)&#xA;&#xA;This will generate a string like:&#xA;&#xA;&amp;gt; echo $P&#xA;{SSHA}giGXGiB2mA8MoaFXU084YuAWPMtPzvQm&#xA;&#xA;&#xA;&#xA;Connecting to AMS LDAP with Apache Directory Studio:&#xA;&#xA;If you don’t have a direct line of sight to the AMS LDAP.. You can use https://github.com/necrolyte2/Apache-Directory-Studio-Tunneller to SSH Tunnel  and use Apache Directory Studio (or other commands) via SSH Tunnel through a server that does have direct connection.&#xA;&#xA;You will need:&#xA;&#xA;1) The above application.  Unzip it to your local drive.&#xA;2) SSH Key in authorized_keys on the server that can talk to EVD.HHS.GOV.&#xA;&#xA;First create/modify settings.yml to look similar to this:&#xA;&#xA;servers:&#xA;    158.74.36.40:&#xA;        port_mappings:&#xA;            8636: 636&#xA;ssh_server:&#xA;    username: yourusername&#xA;    server: ldap-01.dev.hhs.local (or whatever the server is)&#xA;    ident_file: /Users/yourusername/.ssh/id_rsa&#xA;ADS:&#xA;    #This command should not spawn another process. For OS X you need the -W switch for open&#xA;    command_to_open: open -W /Applications/Apache\ Directory\ Studio.app &#xA;&#xA;Then modify ApacheDirectoryStudio.command to something like:&#xA;&#xA;#!/usr/bin/env bash&#xA;./ads_mapper.py ./settings.yml &amp;amp;&#xA;&#xA;Then you can run ApacheDirectoryStudio.command from the command line:&#xA;&#xA;&amp;gt; ./ApacheDirectoryStudio.command&#xA;&#xA;Note:  You might need to install pyYaml if you have not done so previously.&#xA;&#xA;&amp;gt; sudo python -m easy_install pyyaml&#xA;&#xA;After ADS is up and running you can connect to EVD.HHS.GOV by pointing a connection to 127.0.0.1:8636&#xA;&#xA;Bind information is located in 1Password.&#xA;&#xA;&#xA;&#xA;Replication Testing:&#xA;&amp;gt; ldapsearch -z1 -LLLQY EXTERNAL -H ldapi:/// -s base -b dc=hhs,dc=local contextCSN&#xA;&#xA;&#xA;see: LDAP-temporarily-set-user-password-for-testing.ctac.kb.rtfd on how to temporarily set  a users password (and restore).&#xA;&#xA;&#xA;To test ldap authentication when you know the password (the -W prompts for password.):&#xA;&amp;gt;     &amp;gt; ldapsearch -h ldap.domain.local -p 389 -x -b &amp;#34;dc=domain,dc=local&amp;#34; -D &amp;#34;uid=&amp;lt;user id&amp;gt;,ou=people,dc=domain,dc=local&amp;#34; -W&#xA;&#xA;Showing members of a group:&#xA;&#xA;        &amp;gt; ldapsearch -xLLL -b &amp;#34;cn=jira-users,ou=groups,dc=domain,dc=local&amp;#34; -H ldap://ldap.domain.local&#xA;&#xA;Showing a  user&amp;#39;s memberOf attribute:&#xA;&#xA;        &amp;gt; ldapsearch -H ldap://ldap.domain.local:389 -x -D &amp;#34;CN=admin,DC=domain,DC=local&amp;#34; -W -b &amp;#34;ou=people,dc=domain,dc=local&amp;#34; -s sub -a always -z 1000 &amp;#34;(&amp;amp;(uid=prigor))&amp;#34; &amp;#34;memberOf&amp;#34; &amp;#34;objectClass&amp;#34;&#xA;&#xA;&#xA;What if a user can not log into (SSH) a system?&#xA;&#xA;    1) Is the user account a Posix account?  If not, use the ldap_admin script (ldap_add_user) to create a posix account. &#xA;            a) Note all memberOf groups. (Posix groups will not show up)&#xA;            b) If Password is plain text.. note what it is.&#xA;            c) Do an ldif export of the account so you add  back any missing attributes  to the newly created account.&#xA;            d) Convert the plain text password to Crypt.&#xA;    2) Make sure they are using the password associated with the LDAP account.  (Sometimes, the password must be changed — unsure as to why)&#xA;    3) Is the user a member of the right PAM group (check the puppet manifest and node related to the system(s) in question)&#xA;&#xA;What if a user can not log into an ldap service?&#xA;&#xA;    1) Does the user&amp;#39;s memberOf attribute show the [non-posix] group?&#xA;            a) If not, then remove the member attribute for the user and re-add it.&#xA;            b) If so, then perhaps the service uses local groups and you need to add the user manually.&#xA;&#xA;    2) Does the user have the following attributes and are they correct?&#xA;&#x9;    a) carLicence&#xA;            b) departmentNumber&#xA;            c) employeeNumber&#xA;&#xA;&#xA;&#xA;A user can not log into HHS Jira&#xA;    1)  First make sure the LDAP directory is syncing:  https://&amp;lt;jir host&amp;gt;/plugins/servlet/embedded-crowd/directories/list &#xA;    2)  If so, make sure to join the user to the appropriate group (e.g. jira-users) in Administration &amp;gt; Users &amp;gt; Groups &amp;gt; [Group name] &amp;gt; Edit Members&#xA;&#xA;&#xA;A user can not log into FDA Tracker (Jira) Via External LDAP account&#xA;&#xA;1) Do they have an External LDAP Account?&#xA;2) Do they have an employeeNumber (This will typically be their phone number)&#xA;3) Are they a member of the correct groups.&#xA;4) Does their password have special characters that OpenAM does not like?&#xA;5) Try logging in directly to wcdsso.cloud.hhs.gov:8080/openam (if you know their password or have set a temporary one)&#xA;6) Use: https://wcdsso.cloud.hhs.gov/openam/identity/Attributes to get the current attributes.&#xA;&#xA;&#xA;=================================================&#xA;This document is proprietary and confidential. No part of this document may be &#xA;disclosed in any manner to a third party without the prior written consent of &#xA;CTAC.```&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>ldap var lib ldap full logs</title>
      <link>//localhost:1313/en/kb/tools_processes/ldap/ldap-var-lib-ldap-full-logs/</link>
      <pubDate>Sat, 05 Feb 2022 10:31:29 -0500</pubDate>
      <guid>//localhost:1313/en/kb/tools_processes/ldap/ldap-var-lib-ldap-full-logs/</guid>
      <description>&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Knowledge Base Article - CTAC (Communications Training Analysis Corporation)  &#xA;=================================================&#xA;&#xA;Subject: LDAP filling up /var/lib/ldap with log_* files&#xA;&#xA;Revision History:&#xA;    2015-04-09 05:18:45 - Version 1 created by Paul Rigor&#xA;&#xA;Details: (include steps to reproduce, symptoms, corrective actions, contact information, links and a any other helpful information)&#xA;&#xA; If LDAP/OpenLDAP/Slapd fills up /var/lib/ldap with log files ...&#xA;&#xA; Edit /var/lib/ldap/DB_CONFIG and make sure you have DB_LOG_AUTOREMOVE like such.&#xA;&#xA; set_flags DB_LOG_AUTOREMOVE&#xA;&#xA; Restart slapd (service slapd restart)&#xA;&#xA; Note:  If you already have DB_LOG_AUTOREMOVE you may need a checkpoint setting or will just need more disk.  DO NOT manually delete the log files!!!&#xA;&#xA; This is a quick fix ... there is more to LDAP maintenance.. so, as always.. refer to the OpenLDAP manual for more options.&#xA;&#xA;=================================================&#xA;This document is proprietary and confidential. No part of this document may be &#xA;disclosed in any manner to a third party without the prior written consent of &#xA;CTAC.```&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>External LDAP</title>
      <link>//localhost:1313/en/kb/tools_processes/ldap/external-ldap/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>//localhost:1313/en/kb/tools_processes/ldap/external-ldap/</guid>
      <description>&lt;ul&gt;&#xA;&lt;li&gt;ssh into the  ext ldap: 10.140.229.151&lt;/li&gt;&#xA;&lt;li&gt;Find next UID with script below&lt;/li&gt;&#xA;&lt;li&gt;If there is no phone number to use as employee number then use EID from script below&lt;/li&gt;&#xA;&lt;li&gt;sudo su&lt;/li&gt;&#xA;&lt;li&gt;cd to ldap_admin located in /root&lt;/li&gt;&#xA;&lt;li&gt;use ./ldap_add_user&lt;/li&gt;&#xA;&lt;li&gt;once created go to the ext ldap gui&lt;/li&gt;&#xA;&lt;li&gt;ext ldap users employee number is their cell number&lt;/li&gt;&#xA;&lt;li&gt;add employeeNumber and populate with phone number or EID from script&lt;/li&gt;&#xA;&lt;li&gt;IF Employeenumber is the users cell number&#xA;&lt;ul&gt;&#xA;&lt;li&gt;add 3 new attributes: postaladdress, registered address, telephonenumber&lt;/li&gt;&#xA;&lt;li&gt;postal and registered  address is the cell providers email&lt;/li&gt;&#xA;&lt;li&gt;if sprint than itll be &lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;mailto:cellNumber@messaging.com.sprintpcs.com&#34;&#xA;&gt;cellNumber@messaging.com.sprintpcs.com&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;if verizon than itll be &lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;mailto:cellNumber@vtext.com&#34;&#xA;&gt;cellNumber@vtext.com&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;if att than itll be &lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;mailto:cellNUmber@txt.att.net&#34;&#xA;&gt;cellNUmber@txt.att.net&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/bin/bash&#xA;&#xA;MAXUID=`ldapsearch -xLLL -b &amp;#34;ou=people,dc=domain,dc=local&amp;#34; -H ldap://10.140.229.151 | awk &amp;#39;/uidNumber/{ print $NF }&amp;#39;|sort -n |tail -1`&#xA;&#xA;let NEWUID=$MAXUID+1&#xA;EMPCK=$(($NEWUID%7))&#xA;PASSWD=`openssl rand -base64 16`&#xA;&#xA;echo &amp;#34; UID: $NEWUID&amp;#34;&#xA;echo &amp;#34; EID: ${NEWUID}${EMPCK}&amp;#34;&#xA;echo &amp;#34;PASS: ${PASSWD}&amp;#34;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;ldap-grep&#34;&#xA;    &gt;&#xA;        LDAP Grep&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;//localhost:1313/en/kb/tools_processes/ldap/external-ldap/#ldap-grep&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: LDAP Grep&#34; aria-label=&#34;Anchor to: LDAP Grep&#34; href=&#34;#ldap-grep&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;External&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
